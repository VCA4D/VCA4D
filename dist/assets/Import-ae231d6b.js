import{g as fe,u as pe,r as he}from"./economics-9d7282b0.js";import{_ as ee,S as ye}from"./Skeleton-6bbd0d83.js";import{C as D,a8 as le,v as V,a9 as ve,o as _,f as g,a as l,d as y,t as A,u as N,p as te,e as ne,h as W,F as q,l as Q,n as ce,i as M,j as Y,aa as _e,b as w,w as X,R as re,y as ge,H as be,c as Ae}from"./main-ed388a43.js";import{s as T,e as H,i as de,d as Ce}from"./misc-6e2e75d0.js";import{L as Se}from"./LocalStudyBanner-41824019.js";const p={Home:"Value Chain",StagesDescription:"Stages description",ActorTypes:"Actor types",FarmGate:"Farm gate price In final price",Indicators:"Indicator by actor type",ValueAddedReceivers:"Direct value added receivers",Employment:"Employment",AccountByActor:"Account by actor type",ImportExport:"Imported And exported goods",Translation:"AFA Translations",Flows:"Flow by actor type"},C={Country:"Country",Commodity:"Commodity",LocalCcy:"Currency unit AFA",TargetCcy:"Currency (ISO)",RatioCcy:"Conversion rate Currency unit AFA to Currency (ISO)",NominalProtectionCoefficient:"Nominal protection coefficient",DomesticResourceCostRatio:"Domestic resource cost ratio",RateOfIntegrationIntoDomesticEconomy:"Rate of integration into domestic economy",PublicFundsBalanceRatio:"Public funds balance / Public budget",ValueAddedShareNationalGdp:"Value added share of national GDP",ValueAddedShareAgriculturalGdp:"Value added share of the agricultural sector GDP",GiniIndex:"Gini index",FTE_Definition:"Full-time equivalent (FTE) definition"},O={Case:"Case of start and end price",FarmPrice:"Farm gate price (local currency)",FarmProduct:"Farm product",EndPrice:"End products unit value",EndProducts:"End products"},U={AFAName:"AFA Names",EnglishTranslation:"English translation"},L={sellerActorName:"Seller Name",buyerActorName:"Buyer Name",volumeExchanged:"Volume exchanged (kg Of product)",monetaryValue:"Monetary value",unitPrice:"Unitary price (local curency)",volumeUnit:"Volume Unit",product:"Products"},B={ActorName:"Actor type Name",numberOfActors:"Number of actors in the value chain",directAddedValue:"Direct added value (local currency)",publicFundsBalance:"Public funds balance (local currency)",netOperatingProfit:"Net operating profit (local currency)",totalCosts:"Total costs (local currency)"},z={ReceiverName:"Receiver Name",Value:"Value (local currency)"},I={actorType:"Actor type Name",tempMale:"Temporary Male",tempFemale:"Temporary Female",unskilledMale:"Permanent Unskilled Male",unskilledFemale:"Permanent Unskilled Female",skilledMale:"Permanent Skilled Male",skilledFemale:"Permanent Skilled Female"},G={ActorName:"Actor type name",CostOrRevenue:"Cost or Revenue",Item:"Item",Value:"Value"},J={Goods:"Goods",ImportOrExport:"Imported or Exported",Value:"Value (local currency)"},S=(e,t,n=!0)=>{let a="Study id";if(!Object.keys(e).includes(a)&&(a=p.Home,!Object.keys(e).includes(a)))return v("Study id",m.BreaksALot,"Spreadcheet is missing. It should define things such as country, commodity, currency."),null;var s=e[a].find(o=>o.Property===t);return s?s.Value:(n&&v(a,m.BreaksFunctionalities,`Couldn't find '${t}' in excel's sheet '${a}'`),null)},ke=e=>{const t={Stages:"Stages",Description:"Description"};var n=p.StagesDescription,a=E(e,n);if(a!=null)return F(a,t,n,m.BreaksDataviz),a.map((s,o)=>{var i=s[t.Stages],r=s[t.Description];return r||(v(n,m.BreaksInformations,`Add a description to stage <b>${i}</b> in the sheet <b>${n}</b>`),r=""),{name:i,description:r,index:o}})},Ee=e=>{var t=p.Translation,n=E(e,t);if(n!=null){F(n,U,t,m.BreaksInformations);var a={};for(var s of n)s[U.EnglishTranslation]&&s[U.AFAName]&&(a[s[U.AFAName]]=s[U.EnglishTranslation]);return a}},$e=e=>{let t=new Set;e.actors.forEach(n=>{t.has(n.name)?v(p.Translation,m.BreaksFunctionalities,`In spreadsheet '${p.Translation}', after translation applied, more than one actor with the name '${n.name}'`):t.add(n.name)})},Ne=e=>{var t=p.Flows,n=E(e,t);if(n!=null){F(n,L,t,m.BreaksDataviz);var a=[];for(var s of n)if(!(!s[L.buyerActorName]&&!s[L.sellerActorName]&&!s[L.product])){var o={};for(var i in L)o[i]=s[L[i]];a.push(o)}return a}},xe=(e,t)=>{var n=p.Indicators,a=E(e,n);if(a==null)return;F(a,B,n,m.BreaksDataviz);const s=a.map(o=>({actorName:o[B.ActorName],data:{numberOfActors:o[B.numberOfActors]||0,directAddedValue:o[B.directAddedValue]||0,publicFundsBalance:o[B.publicFundsBalance]||0,netOperatingProfit:o[B.netOperatingProfit]||0,totalCosts:o[B.totalCosts]||0}}));return t=t.map(o=>{let i=s.filter(r=>r.actorName===o.name);if(i.length==0&&o.stage!="End use")v(n,m.MayBreakNothing,`In spreadsheet '${n}', data for actor '${o.name}' were not found`);else if(i.length>1)v(n,m.BreaksDataviz,`In spreadsheet '${n}', actor '${o.name}' appears more than once`);else if(i.length===1)return i=i[0],{...o,...i.data};return o}),t},Fe=(e,t)=>{var n=p.ValueAddedReceivers,a=E(e,n);if(a==null)return;F(a,z,n,m.BreaksDataviz);const s=a.map(d=>({receiverName:d[z.ReceiverName],value:d[z.Value]||0}));t=t.map(d=>{const u=s.filter(f=>f.receiverName===d.name)[0];return{...d,receivedAddedValue:(u==null?void 0:u.value)||0}});const o={landOwnersFees:"Land owners (land fees)",depreciation:"Depreciation",employeeWages:"Employees (wages)",financialInstitutionsInterests:"Financial institutions (interests on loans)",government:"Government (taxes - subsidies)"};var i={};for(var r in o){var c=s.filter(d=>d.receiverName===o[r]);c.length==1?i[r]=c[0].value:v(n,m.BreaksDataviz,`In spreadsheet '${n}', couldn't find the following '${z.ReceiverName}' => ${o[r]}`)}return{actors:t,addedValue:i}},Oe=(e,t)=>{var n=p.Employment,a=E(e,n);if(a==null)return;F(a,I,n,m.BreaksDataviz);const s=a.map(Ie),{displayContractRatio:o,displayGenderRatio:i}=Te(s);return t=t.map(r=>{let c=s.filter(d=>d.actorName===r.name);return c&&c.length===1?(c=c[0],{...r,employment:{...c.data}}):r}),{actors:t,displayContractRatio:o,displayGenderRatio:i}};function Ie(e){const t=e[I.actorType],n=d(e[I.tempMale]),a=d(e[I.tempFemale]),s=d(e[I.unskilledMale]),o=d(e[I.unskilledFemale]),i=d(e[I.skilledMale]),r=d(e[I.skilledFemale]);return{actorName:t,data:{tempMale:n,tempFemale:a,unskilledMale:s,unskilledFemale:o,skilledMale:i,skilledFemale:r}};function d(u){return D.isUndefined(u)?null:parseFloat(u)}}function Te(e){const n=a(["tempMale","tempFemale","unskilledMale","unskilledFemale","skilledMale","skilledFemale"]);return Be(n);function a(o){const i={};return o.forEach(r=>i[r]=s(r)),i}function s(o){return De(e,o)?!1:Ve(e,o)?!0:(v(p.Employment,m.BreaksALot,`Column '${I[o]}' of sheet '${p.Employment}' is missing some values`),!1)}}function De(e,t){return e.every(n=>D.isNull(n.data[t]))}function Ve(e,t){return e.every(n=>!D.isNull(n.data[t]))}function Be(e){if(c(Object.values(e)))return{displayContractRatio:!1,displayGenderRatio:!1};let t,n=null;const a=[e.tempFemale,e.unskilledFemale,e.skilledFemale],s=[e.tempMale,e.unskilledMale,e.skilledMale];D.isEqual(a,s)?t=!0:c(a)||c(s)?t=!1:(t=!1,v(p.Employment,m.BreaksALot,"Impossible to compare gender employment: Please fill out every gender employment column for the study's types of contract"));const o=[e.tempFemale,e.tempMale],i=[e.unskilledFemale,e.unskilledMale],r=[e.skilledFemale,e.skilledMale];return D.isEqual(o,i)&&D.isEqual(i,r)?n=!0:c(o)&&c(i)||c(i)&&c(r)||c(r)&&c(o)?n=!1:(n=!1,v(p.Employment,m.BreaksALot,"Impossible to compare contract types: Please fill out every contract type column for the studied gender")),{displayContractRatio:n,displayGenderRatio:t};function c(d){return d.every(u=>!u)}}const Pe=(e,t,n)=>{var a=p.AccountByActor,s=E(e,a);if(s==null)return;F(s,G,a,m.BreaksDataviz);const o=s.map(i=>({actorName:i[G.ActorName],data:{costOrRevenue:i[G.CostOrRevenue],item:i[G.Item],value:i[G.Value]}}));return t=t.map(i=>{let r=o.filter(c=>c.actorName===i.name);return r&&r.length===1?(r=r[0],{...i,accountItems:{...r.data}}):i}),t.sort((i,r)=>{const c=n.find(u=>u.name===i.stage),d=n.find(u=>u.name===r.stage);return((c==null?void 0:c.index)||0)-((d==null?void 0:d.index)||0)}),t},Le=e=>{var t=p.ImportExport,n=E(e,t);if(n==null)return;F(n,J,t,m.BreaksDataviz);const a=n.map(r=>({label:r[J.Goods],importExport:r[J.ImportOrExport],amount:r[J.Value]}));var s={import:[],export:[]},o=["IMPORT","Imported"];for(let r of o)s.import.push(...a.filter(c=>{var d;return((d=c.importExport)==null?void 0:d.localeCompare(r,void 0,{sensitivity:"base"}))===0}));var i=["EXPORT","Exported"];for(let r of i)s.export.push(...a.filter(c=>{var d;return((d=c.importExport)==null?void 0:d.localeCompare(r,void 0,{sensitivity:"base"}))===0}));return a.length>0&&s.import.length==0&&s.import.length==0&&v(t,m.BreaksDataviz,`Column '${J.ImportOrExport}' of excel worksheet '${t}' seems to be wrongly filled.
      It should contains one of '${o}' for import or one of '${i}' for export`),s},Me=(e,t)=>{var n=p.FarmGate,a=E(e,n);if(a!=null){F(a,O,n,m.BreaksDataviz);var s=a.map(o=>(o[O.EndProducts]||v(n,m.BreaksInformations,`In spreadsheet '${n}', case of start and end price named <b>'${o[O.Case]}'</b> has its column <b>${O.EndProducts}</b> empty`),{label:o[O.Case],farmPrice:o[O.FarmPrice],farmProduct:o[O.FarmProduct],endPrice:o[O.EndPrice],endProducts:o[O.EndProducts]}));return t&&t!=1&&(s=s.map(o=>({...o,farmPrice:o.farmPrice/t,endPrice:o.endPrice/t}))),s}},we=(e,t)=>{var n=Object.keys(t);for(var a of e.actors)n.includes(a.name)&&(a.name=t[a.name]);for(var s of e.flows)n.includes(s.sellerActorName)&&(s.sellerActorName=t[s.sellerActorName]),n.includes(s.buyerActorName)&&(s.buyerActorName=t[s.buyerActorName]);return e},Re=(e,t)=>{const n=ke(e);let a=me(e);for(const R of a)R.stage||v(p.ActorTypes,m.BreaksALot,`Actor <b>${R.name}</b> should have a stage defined in worksheet ${p.ActorTypes}`);const s=Ne(e);a=xe(e,a);var o=Fe(e,a);a=o.actors;var i=o.addedValue;let r=Oe(e,a);a=r.actors;const c={employment:{contractRatio:r.displayContractRatio,genderRatio:r.displayGenderRatio}};a=Pe(e,a,n);var d=Le(e);const u=Me(e,t);var f={};f.giniIndex=S(e,C.GiniIndex),f.FTE_Definition=S(e,C.FTE_Definition),f.rateOfIntegration=S(e,C.RateOfIntegrationIntoDomesticEconomy)/100||void 0,f.publicFundsBalance=S(e,C.PublicFundsBalanceRatio)/100||void 0,f.valueAddedShareNationalGdp=S(e,C.ValueAddedShareNationalGdp)/100||void 0,f.valueAddedShareAgriculturalGdp=S(e,C.ValueAddedShareAgriculturalGdp)/100||void 0,f.domesticResourceCostRatio=S(e,C.DomesticResourceCostRatio),f.nominalProtectionCoefficient=S(e,C.NominalProtectionCoefficient);var h={macroData:f,stages:n,actors:a,consistencyDisplay:c,flows:s,addedValue:i,importExport:d,farmToFinalPricesRatio:u};const k=Ee(e);return k&&(h=we(h,k),$e(h)),Ue(h),h},Ue=e=>{let t=ue();const n=e.actors.map(r=>r.name);let a=[];a=a.concat(e.flows.filter(r=>!n.includes(r.buyerActorName)).reduce((r,c)=>r.concat(c.buyerActorName),[])),a=a.concat(e.flows.filter(r=>!n.includes(r.sellerActorName)).reduce((r,c)=>r.concat(c.buyerActorName),[])),a.map(r=>{v(p.Flows,"error",`Actor named <b>${r}</b> in sheet <b>${p.Flows}</b> is not defined in sheet <b>${p.ActorTypes}</b>`)});const s=fe({ecoData:e});let o=e.actors.map(r=>r.receivedAddedValue).reduce((r,c)=>r+c,0);for(const r in e.addedValue)o+=e.addedValue[r];return Math.round(Math.abs(s-o))>0&&v(p.Indicators,"error",`Total added value created found in spreadsheet '${p.Indicators}' is ${s}. And total added value received found in spreadsheet '${p.ValueAddedReceivers}' is ${o}. But both should be equal`),t},K={Home:"Value Chain",ValueChainsDescription:"Value chains description",ActorTypes:"Actor types",Impacts:"Impacts"},Ge=e=>{var t=K.ValueChainsDescription,n=E(e,t);if(n==null)return;const a=n.filter(s=>s["Value chain name"]!=null&&(s["annual volume"]!=null||s["year of volume"]!=null||s.unit!=null)).map(s=>({name:s["Value chain name"],volume:s["annual volume"],volumeYear:s["year of volume"],volumeUnit:s.unit}));for(const s of a)s.volume||v(t,m.BreaksALot,`Volume missing for value chain <b>${s.name}</b> in sheet <b>${t}</b>`);return a},Je=(e,t)=>{var n="Actors and Chains matrix",a=E(e,n);if(a!=null)for(var s of a){var o=s["Sub-chain"],i=t.find(r=>r.name==o);if(!i){v(n,m.MayBreakNothing,`Found an unknown chain value named ${o} in sheet ${n}`);continue}i.actors={...s},delete i.actors["Sub-chain"]}},x={name:"Impact category",method:"LCIA method",functional_unit:"Functional Unit",unit:"Sub-chain →"},Z="Sub-chain total",He=(e,t,n,a,s)=>{var o={};for(var i of Object.keys(x))x[i]in e?delete e[x[i]]:v(a,m.BreaksALot,`The column ${x[i]} is missing in first row of sheet ${a}.

        First cell of this column must contains '${x[i]}' only, and second cell must not be empty

        ${Object.keys(e)}
`);for(var r in e){var c=/([^_]*)_?[0-9]*/.exec(r),d=n.filter(h=>h.name==c[1]);if(d.length!=1){v(a,m.BreaksALot,`The chain value defined on first line of sheet ${a}, named |${c[1]}| should match one of the following value chain name:

        ${n.map(h=>h.name)}`);continue}var u=s.map(h=>h.name);u.includes(t[r])?o[r]={valuechain_name:d[0].name,actor_name:t[r]}:e[r]==Z?o[r]={valuechain_name:d[0].name,actor_name:Z}:v(a,m.BreaksALot,`The actor named |${t[r]}| on third line of sheet ${a}, should match one of the following actors:
        
${u}`)}return o},ze=(e,t,n)=>{var a=[],s=K.Impacts,o=E(e,s);if(o==null)return null;var i=0,r={},c=null;for(var d of o){var u={...d};if(++i,i==1){c=u;continue}if(i==2){r=He(c,u,t,s,n);continue}var f={};for(var h of Object.keys(x))x[h]in u?(f[h]=u[x[h]],delete u[x[h]]):v(s,m.BreaksDataviz,`The column ${x[h]} in sheet ${s} is not filled at line ${i+1}`);f.values=[];for(var k in u)if(k in r&&r[k].actor_name!=Z){var R=f.values.filter(oe=>oe.actor_name==r[k].actor_name&&oe.valuechain_name==r[k].valuechain_name);R.length==1?R[0].value+=u[k]:f.values.push({...r[k],value:u[k]})}a.push(f)}return a},We=e=>{let t=Ge(e),n=me(e);Je(e,t);var a=ze(e,t,n);return{valuechains:t,actors:n,impacts:a}},b=(e,t,n)=>{var s,o;return{title:(s=e[`A${t}`])==null?void 0:s.v,averageValue:(o=e[`E${n}`])==null?void 0:o.v,questions:Array.from(Array(n-1-(t+1)+1).keys(),i=>i+t+1).map(a)};function a(i){var c,d;return{text:r().trim(),scoreValue:(c=e[`E${i}`])==null?void 0:c.v,comment:(d=e[`F${i}`])==null?void 0:d.v.trim()};function r(){var h;const u="1.1.3 To what extent do workers benefit from enforceable and fair contracts ",f=(h=e[`A${i}`])==null?void 0:h.v;return f===u?f.replace(/ $/,"?"):f}}},qe=e=>{var t,n,a,s,o,i;return[{title:(t=e.A3)==null?void 0:t.v,groups:[b(e,4,10),b(e,11,14),b(e,15,17),b(e,18,21)]},{title:(n=e.A22)==null?void 0:n.v,groups:[b(e,23,26),b(e,27,32),b(e,33,38)]},{title:(a=e.A39)==null?void 0:a.v,groups:[b(e,40,43),b(e,44,49),b(e,50,56),b(e,57,62),b(e,63,66)]},{title:(s=e.A67)==null?void 0:s.v,groups:[b(e,68,71),b(e,72,75),b(e,76,80),b(e,81,84)]},{title:(o=e.A85)==null?void 0:o.v,groups:[b(e,86,91),b(e,92,95),b(e,96,100)]},{title:(i=e.A101)==null?void 0:i.v,groups:[b(e,102,106),b(e,107,110),b(e,111,115)]}]},Ke=e=>{var i,r;const t="Questionnaire",n=e.Sheets[t],a=T((i=n.D1)==null?void 0:i.v),s=(r=n.B1)==null?void 0:r.v.trim(),o=null;return{id:T(s+"-"+a),country:a,commodity:s,year:o,type:"social",socialData:qe(n)}};let ae=[];const Qe=()=>{ae=[]},m=Object.freeze({BreaksALot:"BreaksALot",BreaksDataviz:"BreaksDataviz",BreaksFunctionalities:"BreaksFunctionalities",BreaksInformations:"BreaksInformations",MayBreakNothing:"MayBreakNothing"}),v=(e,t,n)=>{ae.push({level:t,spreadsheet:e,message:n})},ue=()=>ae,E=(e,t)=>Object.keys(e).includes(t)?e[t]:(v(t,m.BreaksALot,`Sheet '${t}' is missing.`),null),me=e=>{const t={name:"Actor type name",stage:"Stage"};var n=p.ActorTypes,a=e[p.ActorTypes];return F(a,t,n,m.BreaksALot),a.filter(s=>s["Actor type name"]!=null).map(s=>({name:s["Actor type name"],stage:s.Stage||"",id:s["Actor type code"]}))},Ye=(e,t)=>{var n=e.find(a=>a[t]!=null);return!!n},F=(e,t,n,a)=>{for(var s in t)Ye(e,t[s])||v(n,a,`In spreadsheet '${n}', column '${t[s]}' is missing or empty`)},P={Sustainability:"Sustainability",Environment:"Environment",Economics:"Economics"},Xe=e=>{const t="Questionnaire",n=["Value chains description"],a=["Stages description"];return e.Sheets[t]?P.Sustainability:e.Sheets[n[0]]?P.Environment:e.Sheets[a[0]]?P.Economics:(v(t,m.BreaksALot,`Missing sheet. At least one of the following should be in the file: '${t}', '${n[0]}' or '${a[0]}' depending of the excel type, ${Object.keys(P)}`),null)},Ze=e=>{const t=S(e,C.LocalCcy);var n=S(e,C.TargetCcy,!0),a=null;if(H(t)&&!H(n))n=t,a=1;else if(H(n))a=S(e,C.RatioCcy);else if(!H(t))return v(p.Home,m.BreaksFunctionalities,`Either currencies defined by '${C.LocalCcy}' or '${C.TargetCcy}' should be an ISO currency code. Find all valid currency code by visiting https://en.wikipedia.org/wiki/ISO_4217#List_of_ISO_4217_currency_codes`),{localCurrency:null,targetCurrency:null,currencyRatio:null};return de(n)||v(p.Home,m.BreaksFunctionalities,`We don't have the rate change to USD for currency '${n}'. Please send an e-mail with it to the administrator`),{localCurrency:t,targetCurrency:n,currencyRatio:a}},je=e=>{Qe();let t=Xe(e),n={};t===P.Sustainability&&(n=Ke(e));let a={};if(e.SheetNames.forEach(o=>{const i=pe.sheet_to_json(e.Sheets[o]);a[o]=i}),t===P.Economics){const o=S(a,"Reference Year"),i=Ze(a);n={...ie(S(a,C.Commodity),T(S(a,C.Country))),year:o,...i,type:"eco",ecoData:Re(a,i.currencyRatio)}}else t===P.Environment&&(n={...ie(S(a,C.Commodity),T(S(a,C.Country))),type:"ACV",acvData:We(a)});return le().includes(T(n.commodity))||v(p.Home,m.BreaksALot,`Commodity <b>${T(n.commodity)}</b> is not recognized.`),{data:n,errors:ue()}};function ie(e,t){return{id:T(e+"-"+t),country:t,commodity:e}}function et(e,t){e.studies.find(i=>i.id===t.id)||e.studies.push({id:`${t.id}`,title:`${t.country} ${t.commodity}`,year:t.year,country:t.country.toLowerCase(),product:t.commodity.toLowerCase()}),e.studies.sort(j(["country","product"]));const n=T(t.country);e.countries.find(i=>i.id===n)||e.countries.push({id:n,prettyName:t.country}),e.countries.sort(j(["id"]));const a=e.categories.reduce((i,r)=>i.concat(r.commodities),[]),s=t.commodity.toLowerCase();a.includes(s)||e.categories.find(i=>i.id==="unknown").commodities.push(s);const o=D.uniq(e.studies.map(i=>i.product));return e.products=tt(e.products,o),JSON.stringify(e,null,2)}function tt(e=[],t){const n=[...e];return t.forEach(a=>{e.find(s=>s.id===a)||n.push({id:a,prettyName:D.capitalize(a)})}),n.sort(j("id")),n}function j(e){return function(t,n){for(var a of e){if(t[a]<n[a])return-1;if(t[a]>n[a])return 1}return 0}}const nt="/VCA4D/dist/assets/upload_files_on_github-2538ec99.png",at="/VCA4D/dist/assets/new_folder-9934c9ec.png";const $=e=>(te("data-v-7b7d33e8"),e=e(),ne(),e),st={class:"my-4"},ot=$(()=>l("h2",null,"Step 3 : Add study to the repository",-1)),rt=$(()=>l("p",null,[l("strong",null,"1."),y(" Download both following files")],-1)),it=$(()=>l("p",null,[l("strong",null,"2."),y(' Add the data file as "data.json" in the "data" folder')],-1)),lt=$(()=>l("strong",null,"3.",-1)),ct=$(()=>l("br",null,null,-1)),dt={class:"how-to"},ut=$(()=>l("h3",null,"How to add a file:",-1)),mt=$(()=>l("p",null,[y(" Go to "),l("a",{href:"https://github.com/VCA4D/VCA4D/tree/main/data"},"https://github.com/VCA4D/VCA4D/tree/main/data"),y(" with a VCA4D authorised account ")],-1)),ft=$(()=>l("strong",null,"after renaming the file on your computer",-1)),pt=["src"],ht={class:"how-to"},yt=$(()=>l("h3",null,"How to create a file in a new folder:",-1)),vt=$(()=>l("li",null,'Click on "Add file" at the top right and choose "Create new file" instead.',-1)),_t=["src"],gt=$(()=>l("li",null,"Then, copy paste the file's content and commit changes",-1)),bt={__name:"SaveOnGithubStep",props:{studyData:Object},setup(e){const t=e,n=V(()=>JSON.stringify(t.studyData,null,2)),a=V(()=>t.studyData.type=="eco"?`${t.studyData.id}-eco`:t.studyData.type=="ACV"?`${t.studyData.id}-acv`:t.studyData.type=="social"?`${t.studyData.id}-social`:null),s=V(()=>et(ve,t.studyData)),o=(c,d)=>{const u=new Blob([c],{type:"application/json"}),f=URL.createObjectURL(u),h=document.createElement("a");h.href=f,h.download=d,h.click(),URL.revokeObjectURL(f)},i=()=>{o(n.value,`${a.value}.json`)},r=()=>{o(s.value,"data.json")};return(c,d)=>(_(),g("div",st,[ot,rt,l("div",{class:"flex flex-row mb-2 gap-x-2"},[l("button",{class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",onClick:r}," Download data file "),l("button",{class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",onClick:i}," Download study file ")]),it,l("p",null,[lt,y(' Under the "'+A(`/${e.studyData.id}`)+`" folder (you can create it if it doesn't exist), upload the study file as "`+A(`${a.value}.json`)+'" , and the excel file as "'+A(`${a.value}.xlsx`)+'" ',1)]),ct,l("div",dt,[ut,mt,y(" Go to the right folder, and "),ft,y(', click on "Add file" at the top right and choose "Upload Files" '),l("img",{src:N(nt),alt:"github screenshot"},null,8,pt),y(' Click on "Commit changes", and write a commit message (example: "Adding burkina faso mango social study"). Then commit ')]),l("div",ht,[yt,l("ul",null,[vt,l("li",null,[y(' On the top bar, you can type "name-of-the-new-folder/" which will create the file in a new folder '),l("img",{src:N(at),alt:"github screenshot"},null,8,_t)]),gt])])]))}},At=ee(bt,[["__scopeId","data-v-7b7d33e8"]]);const Ct=e=>(te("data-v-54c788b1"),e=e(),ne(),e),St={class:"contents-of-the-file"},kt={key:0,class:"tab-present"},Et={class:"property"},$t={class:"error-title"},Nt=Ct(()=>l("span",{class:"checkmark"},"✕",-1)),xt=["innerHTML"],Ft={__name:"ImportWarning",props:{errors:Object,spreadsheetName:String},setup(e){const t=e,n=V(()=>t.errors.length==0?!0:t.errors.length==1&&t.errors[0].message==`Sheet '${t.spreadsheetName}' is missing.`);return(a,s)=>(_(),g("div",St,[l("div",{class:ce({tab_ok:e.errors.length==0,tab_in_error:e.errors.length>0})},[l("h3",null,"Tab: "+A(e.spreadsheetName),1),n.value?W("",!0):(_(),g("p",kt,"Tab present in the file")),(_(!0),g(q,null,Q(e.errors,(o,i)=>(_(),g("div",{key:i},[l("div",Et,[l("p",$t,[Nt,y(" "+A(o.level),1)]),l("p",{innerHTML:o.message},null,8,xt)])]))),128))],2)]))}},Ot=ee(Ft,[["__scopeId","data-v-54c788b1"]]),It=l("h2",null,"Step 2 : Check that all data is there.",-1),Tt=l("p",null,"Complete the file for missing data, then re-upload the file (back to step 1).",-1),Dt=l("a",{href:"https://github.com/VCA4D/VCA4D/tree/main/data/xls",target:"_blank"},"Here you can find example blank file to help you upload your study",-1),Vt=l("h4",null,"Contents of the file",-1),Bt={class:"flex flex-col items-center"},Pt={class:"mt-4 flex flex-row gap-x-4"},Lt=l("button",{class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"}," Find your study on the home page ",-1),Mt=l("button",{class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded"}," Browse this study ",-1),wt={class:"flex flex-col gap-y-4 text-left mt-2 text-lg mx-auto max-w-5xl"},Rt=l("h2",null,"Summary",-1),Ut={class:"flex flex-row"},Gt=l("div",{class:"w-1/4"},[l("h3",{class:"table-cell"},"Type of file")],-1),Jt={class:"flex flex-row w-3/4"},Ht={class:"flex flex-row"},zt=l("div",{class:"w-1/4"},[l("h3",{class:"table-cell"},"Country")],-1),Wt={class:"w-3/4"},qt={key:0,class:"text-2xl"},Kt={key:1,class:"text-red-600"},Qt=l("br",null,null,-1),Yt={class:"flex flex-row items-center"},Xt=l("div",{class:"w-1/4"},[l("h3",{class:"table-cell"},"Product")],-1),Zt={class:"w-3/4"},jt={key:0,class:"text-2xl"},en={key:1,class:"text-red-600"},tn=l("br",null,null,-1),nn={key:0,class:"flex flex-row items-center"},an=l("div",{class:"w-1/4"},[l("h3",{class:"table-cell"},"Currency")],-1),sn={class:"w-3/4 text-xl"},on={key:0},rn={key:0,class:"text-red-600"},ln={key:1,class:"text-red-600"},cn=l("br",null,null,-1),dn=l("a",{class:"font-semibold underline",href:"https://en.wikipedia.org/wiki/ISO_4217#List_of_ISO_4217_currency_codes",target:"_blank"},"this wiki page.",-1),un={key:1},mn={key:0},fn={key:1},pn={__name:"CheckImportedDataStep",props:{studyData:Object,importErrors:Array},setup(e){const t=e,n={Sustainability:"social",Environment:"ACV",Economics:"eco"},a=M([]),s=M([]);Y(async()=>{a.value=_e(),s.value=le()});const o=V(()=>a.value.find(c=>c.id===t.studyData.country)),i=V(()=>{var c;return s.value.includes((c=t.studyData.commodity)==null?void 0:c.toLowerCase())}),r=V(()=>{let c={};return t.studyData.type==="eco"?Object.keys(p).forEach(d=>{c[p[d]]=[]}):t.studyData.type==="ACV"&&Object.keys(K).forEach(d=>{c[K[d]]=[]}),t.importErrors.forEach(d=>{c[d.spreadsheet]||(c[d.spreadsheet]=[]),c[d.spreadsheet].push(d)}),c});return(c,d)=>(_(),g("div",null,[It,Tt,Dt,Vt,(_(!0),g(q,null,Q(r.value,(u,f,h)=>(_(),g("div",{key:h},[w(Ot,{spreadsheetName:f,errors:u},null,8,["spreadsheetName","errors"])]))),128)),l("div",Bt,[l("div",Pt,[y(" Check the study appears on the front page, and at the right place "),w(N(re),{to:"/"},{default:X(()=>[Lt]),_:1}),y(" Check the study's data are well transformed into graphic on dedicated page(s) "),w(N(re),{to:"/study?id=localStorage"},{default:X(()=>[Mt]),_:1})])]),l("div",wt,[Rt,l("div",Ut,[Gt,l("div",Jt,[(_(),g(q,null,Q(n,u=>l("div",{key:u,class:ce(["bg-gray-200 rounded mr-8 px-4 py-2 border border-gray-400",{"bg-green-300 font-semibold border-2":e.studyData.type===u}])},A(u),3)),64))])]),l("div",Ht,[zt,l("div",Wt,[o.value?(_(),g("div",qt,A(o.value.prettyName),1)):(_(),g("div",Kt,[y(" Unknown country: "),l("b",null,A(e.studyData.country),1),Qt,y(" Known countries are: "),l("b",null,A(a.value.sort((u,f)=>u.id.localeCompare(f.id)).map(u=>u.prettyName).join(", ")),1),y(" Please respect name and isocode from https://en.wikipedia.org/wiki/ISO_3166-1 to add new countries ")]))])]),l("div",Yt,[Xt,l("div",Zt,[i.value?(_(),g("div",jt,A(e.studyData.commodity),1)):(_(),g("div",en,[y(" Unknown commodity: "),l("b",null,A(N(T)(e.studyData.commodity)),1),tn,y(" Known commodities are: "),l("b",null,A(s.value.sort((u,f)=>u.localeCompare(f)).join(", ")),1)]))])]),e.studyData.type===n.Economics?(_(),g("div",nn,[an,l("div",sn,[N(H)(e.studyData.targetCurrency)?(_(),g("div",un,[N(de)(e.studyData.targetCurrency,e.studyData.year)?(_(),g("div",fn," This study is in "+A(e.studyData.localCurrency)+" and will be converted to "+A(e.studyData.targetCurrency)+" with a rate of "+A(e.studyData.currencyRatio),1)):(_(),g("div",mn,[y(" Currency "),l("b",null,A(e.studyData.targetCurrency),1),y(" is valid but we do not have it's rate change to USD for the year's study ("+A(e.studyData.year)+"). ",1)]))])):(_(),g("div",on,[e.studyData.localCurrency!=null?(_(),g("span",rn,[y(" Currency "),l("b",null,A(e.studyData.localCurrency),1),y(" defined in cell "),l("b",null,A(N(C).LocalCcy),1),y(" or "),l("b",null,A(N(C).TargetCcy),1),y(" is not valid. ")])):(_(),g("span",ln,[l("b",null,A(N(C).LocalCcy),1),y(" not found in uploaded file. ")])),cn,y(" Find all valid currencies code by visiting "),dn]))])])):W("",!0)])]))}};const se=e=>(te("data-v-20051fbc"),e=e(),ne(),e),hn={class:"corps-page-import"},yn=se(()=>l("h1",null,"Add a study to the VCA4D website",-1)),vn=se(()=>l("h2",null,"Step 1 : Import a study file",-1)),_n={key:0},gn={key:1},bn=se(()=>l("br",null,null,-1)),An={key:0},Cn={__name:"Import",setup(e){const t=M(null),n=()=>{Ce(),t.value=null},a=M([]);Y(async()=>{const c=ge();a.value=c.categories.reduce((d,u)=>d.concat(u.commodities),[])});const s=V(()=>r.value?Object.keys(r.value).length>0:!1),o=c=>{n();const d=c.target.files[0];if(d){const u=new FileReader;u.onload=f=>{const h=f.target.result,k=he(h,{type:"binary"});t.value=k,localStorage.setItem("localWorkbook",JSON.stringify(k))},u.readAsArrayBuffer(d)}},i=M([]),r=M(null);return be(()=>t.value,()=>{if(!t.value){r.value=null,i.value=[];return}let{data:c,errors:d}=je(t.value);localStorage.setItem("localStudyData",JSON.stringify(c)),r.value=c,i.value=d}),Y(()=>{const c=localStorage.getItem("localWorkbook");c&&(t.value=JSON.parse(c))}),(c,d)=>(_(),g(q,null,[s.value?(_(),Ae(Se,{key:0,onClickClear:n})):W("",!0),w(ye,{skipFooter:!0},{default:X(()=>[l("div",hn,[yn,vn,l("div",null,[s.value?(_(),g("div",_n,[l("div",null,[y(" You have imported this study: "),l("b",null,A(r.value.id),1)]),l("div",{class:"ml-4"},[y(" Press "),l("a",{class:"cursor-pointer",onClick:n},"Remove"),y(" or ")])])):(_(),g("p",gn,"Upload the file to the platform")),bn,l("input",{type:"file",onChange:o},null,32)]),s.value?(_(),g("div",An,[w(pn,{studyData:r.value,importErrors:i.value},null,8,["studyData","importErrors"]),w(At,{studyData:r.value},null,8,["studyData"])])):W("",!0)])]),_:1})],64))}},xn=ee(Cn,[["__scopeId","data-v-20051fbc"]]);export{xn as default};
